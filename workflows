version: "1"

tests:
  - name: "Maseno App – API Health Check"
    type: api
    subtype: http
    request:
      url: "https://api.masenotrading.com/health"
      method: GET
    assertions:
      - type: statusCode
        operator: is
        target: 200
      - type: body
        operator: contains
        target: "OK"
    options:
      tick_every: 300
    locations:
      - aws:eu-west-1
    tags:
      - app:maseno
      - platform:mobile
      - env:production
      - service:backend

  - name: "Maseno App – Mobile Login API"
    type: api
    subtype: http
    request:
      url: "https://api.masenotrading.com/auth/login"
      method: POST
      headers:
        Content-Type: application/json
      body: |
        {
          "email": "{{ MASENO_TEST_EMAIL }}",
          "password": "{{ MASENO_TEST_PASSWORD }}"
        }
    assertions:
      - type: statusCode
        operator: is
        target: 200
      - type: jsonPath
        operator: isNotEmpty
        target: "$.access_token"
    options:
      tick_every: 600
    locations:
      - aws:eu-west-1
    tags:
      - app:maseno
      - platform:mobile
      - env:production
      - service:auth

  - name: "Maseno App – Fetch Products (Authenticated)"
    type: api
    subtype: http
    request:
      url: "https://api.masenotrading.com/products"
      method: GET
      headers:
        Authorization: "Bearer {{ MASENO_API_TOKEN }}"
    assertions:
      - type: statusCode
        operator: is
        target: 200
      - type: jsonPath
        operator: isNotEmpty
        target: "$[0].id"
    options:
      tick_every: 600
    locations:
      - aws:eu-west-1
    tags:
      - app:maseno
      - platform:mobile
      - env:production
      - service:products
